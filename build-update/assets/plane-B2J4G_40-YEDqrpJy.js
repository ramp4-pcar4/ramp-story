import{bL as J,f6 as K,cB as N,hc as y,cJ as I,hk as d,cK as Q,cM as A,cN as M,hg as x,cC as j,c9 as z,cH as F,cO as _,eH as v}from"./story-DE9AooAy.js";import{n as G}from"./mat3f64-Dh9_zhFu-BIT-k8Dm.js";import{t as Y}from"./mat4f64-Dn1WEGBx-C99QVUMW.js";import{e as $}from"./quatf64-C16JxGFv-BKWK1F8U.js";function L(t,e){return I(t,e)/d(t)}function Nt(t,e){const r=I(t,e)/(d(t)*d(e));return-Q(r)}function Et(t,e,r){_(C,t),_(X,e);const c=I(C,X),a=Q(c),i=A(C,C,X);return I(i,r)<0?2*Math.PI-a:a}const C=N(),X=N();let S=class E{constructor(e){this._create=e,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&J(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const e=2*this._itemsPtr;this._items.length>e&&(this._items.length=e),this._itemsPtr=0}static createVec2f64(){return new E(K)}static createVec3f64(){return new E(N)}static createVec4f64(){return new E(y)}static createMat3f64(){return new E(G)}static createMat4f64(){return new E(Y)}static createQuatf64(){return new E($)}get test(){}};const ht=S.createVec2f64(),f=S.createVec3f64(),W=S.createVec4f64();S.createMat3f64();const Tt=S.createMat4f64(),Mt=S.createQuatf64();function _t(t){const e=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],r=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],c=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(e,r,c))}function St(t,e){const r=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),c=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),a=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return F(t,r,c,a),t}function Z(t,e,r){Math.abs(t[0])>Math.abs(t[1])?F(e,0,1,0):F(e,1,0,0),A(r,t,e),A(e,r,t),_(r,r),_(e,e)}function k(t=O){return[t[0],t[1],t[2],t[3]]}function mt(t=O[0],e=O[1],r=O[2],c=O[3]){return H(t,e,r,c,W.get())}function tt(t,e){return H(e[0],e[1],e[2],e[3],t)}function gt(t){return t}function H(t,e,r,c,a=k()){return a[0]=t,a[1]=e,a[2]=r,a[3]=c,a}function et(t,e,r){const c=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],a=Math.abs(c-1)>1e-5&&c>1e-12?1/Math.sqrt(c):1;return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function rt(t,e,r,c=k()){const a=r[0]-e[0],i=r[1]-e[1],n=r[2]-e[2],s=t[0]-e[0],D=t[1]-e[1],U=t[2]-e[2],m=i*U-n*D,R=n*s-a*U,V=a*D-i*s,p=m*m+R*R+V*V,q=Math.abs(p-1)>1e-5&&p>1e-12?1/Math.sqrt(p):1;return c[0]=m*q,c[1]=R*q,c[2]=V*q,c[3]=-(c[0]*t[0]+c[1]*t[1]+c[2]*t[2]),c}function ct(t,e,r,c=0,a=Math.floor(r*(1/3)),i=Math.floor(r*(2/3))){if(r<3)return!1;e(g,c);let n=a,s=!1;for(;n<r-1&&!s;)e(T,n),n++,s=!v(g,T);if(!s)return!1;for(n=Math.max(n,i),s=!1;n<r&&!s;)e(h,n),n++,M(l,g,T),_(l,l),M(P,T,h),_(P,P),s=!v(g,h)&&!v(T,h)&&Math.abs(I(l,P))<at;return s?(rt(g,T,h,t),!0):(c!==0||a!==1||i!==2)&&ct(t,e,r,0,1,2)}const at=.99619469809,g=N(),T=N(),h=N(),l=N(),P=N();function Ot(t,e,r){return e!==t&&tt(t,e),t[3]=-I(t,r),t}function Dt(t,e,r,c){return A(h,e,t),et(r,h,c)}function Ut(t,e,r,c){return b(w(t,e,M(f.get(),r,e),nt,c))}function Ct(t,e,r){return e!=null&&b(w(t,e.origin,e.direction,it,r))}function lt(t,e,r){return b(w(t,e.origin,e.vector,u.NONE,r))}function Pt(t,e,r){return b(w(t,e.origin,e.vector,u.CLAMP,r))}function At(t,e){return B(t,e)>=0}function Ft(t,e,r){const c=x(f.get(),t,-t[3]),a=st(t,M(f.get(),e,c),f.get());return j(r,a,c),r}function bt(t,e,r,c){const a=t,i=f.get(),n=f.get();Z(a,i,n);const s=M(f.get(),r,e),D=L(i,s),U=L(n,s),m=L(a,s);return F(c,D,U,m)}function st(t,e,r){const c=x(f.get(),t,I(t,e));return M(r,e,c),r}function wt(t,e){return Math.abs(B(t,e))}function B(t,e){return I(t,e)+t[3]}var o;function b(t){return t===o.INTERSECTS_INSIDE_OUT||t===o.INTERSECTS_OUTSIDE_IN}function w(t,e,r,c,a){const i=I(t,r),n=B(t,e);if(i===0)return n>=0?o.INSIDE:o.OUTSIDE;let s=-n/i;return c&u.CLAMP&&(s=z(s,0,1)),!(c&u.INFINITE_MIN)&&s<0||!(c&u.INFINITE_MAX)&&s>1?n>=0?o.INSIDE:o.OUTSIDE:(j(a,e,x(a,r,s)),n>=0?o.INTERSECTS_INSIDE_OUT:o.INTERSECTS_OUTSIDE_IN)}(function(t){t[t.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",t[t.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE"})(o||(o={}));const O=[0,0,1,0];var u;(function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"})(u||(u={}));const nt=u.INFINITE_MIN|u.INFINITE_MAX,it=u.INFINITE_MAX;export{tt as $,k as B,Ft as D,rt as G,St as I,Z as J,ct as K,Ct as M,gt as N,bt as O,L as P,lt as S,Dt as T,Ut as _,Nt as a,mt as b,Et as c,B as d,Tt as e,f,At as g,Ot as h,ht as i,et as j,H as k,wt as l,Pt as m,Mt as o,_t as u,W as z};
