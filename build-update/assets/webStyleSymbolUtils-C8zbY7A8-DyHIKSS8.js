import{q as S,an as q,ae as w,h as c,ao as f,ap as N,aq as $,ar as D,as as O,at as E,au as g,av as h,aw as F,ax as P}from"./story-u82SUoyt.js";import{i as v,m as d}from"./devEnvironmentUtils-CxrVv3RG-CX5aoxVE.js";import"./main-CmCzAIzx.js";function L(e,t,a,l){const n=e.name;return n==null?Promise.reject(new S("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):e.styleName==="Esri2DPointSymbolsStyle"?R(n,t,l):q(e,t,l).then(s=>I(s,n,t,a,P,l))}function x(e,t){return t.items.find(a=>a.name===e)}function I(e,t,a,l,n,s){const o=a?.portal!=null?a.portal:w.getDefault(),p={portal:o,url:c(e.baseUrl),origin:"portal-item"},m=x(t,e.data);if(!m){const y=`The symbol name '${t}' could not be found`;return Promise.reject(new S("symbolstyleutils:symbol-name-not-found",y,{symbolName:t}))}let i=f(n(m,l),p),u=m.thumbnail?.href??null;const b=m.thumbnail?.imageData;v()&&(i=d(i)??"",u=d(u));const U={portal:o,url:c(N(i)),origin:"portal-item"};return $(i,s).then(y=>{const W=l==="cimRef"?D(y.data):y.data,r=O(W,U);if(r&&E(r)){if(u){const j=f(u,p);r.thumbnail=new g({url:j})}else b&&(r.thumbnail=new g({url:`data:image/png;base64,${b}`}));e.styleUrl?r.styleOrigin=new h({portal:a.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(r.styleOrigin=new h({portal:a.portal,styleName:e.styleName,name:t}))}return r})}function R(e,t,a){const l=F.replaceAll(/\{SymbolName\}/gi,e),n=t.portal!=null?t.portal:w.getDefault();return $(l,a).then(s=>{const o=D(s.data);return O(o,{portal:n,url:c(N(l)),origin:"portal-item"})})}export{I as fetchSymbolFromStyle,x as getStyleItemFromStyle,L as resolveWebStyleSymbol};
